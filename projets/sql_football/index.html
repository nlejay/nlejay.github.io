
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://monsite.fr/projets/sql_football/">
      
      
        <link rel="prev" href="../PBI_accidents/">
      
      
        <link rel="next" href="../ips/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>• Résultats de football - Portfolio de projets data / Nicolas Lejay</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#resultats-des-championnats-europeens-de-football-entre-2005-et-2021" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Portfolio de projets data / Nicolas Lejay" class="md-header__button md-logo" aria-label="Portfolio de projets data / Nicolas Lejay" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Portfolio de projets data / Nicolas Lejay
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              • Résultats de football
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Accueil

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../python_accidents/" class="md-tabs__link">
          
  
    
  
  Python

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../app_non_sup/" class="md-tabs__link">
          
  
    
  
  Machine Learning

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../PBI_accidents/" class="md-tabs__link">
          
  
    
  
  Power BI

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  SQL

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ips/" class="md-tabs__link">
          
  
    
  
  Tableur

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../APropos/" class="md-tabs__link">
          
  
    
  
  Mon parcours

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Portfolio de projets data / Nicolas Lejay" class="md-nav__button md-logo" aria-label="Portfolio de projets data / Nicolas Lejay" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Portfolio de projets data / Nicolas Lejay
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accueil
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python_accidents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Accidents de la route - P1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python_accidents2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Accidents de la route - P2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../medecins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Densité de médecins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seismes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Séismes dans le monde en 2022
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Machine Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Machine Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app_non_sup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Apprentissage non supervisé
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app_sup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Apprentissage supervisé
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Power BI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Power BI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PBI_accidents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Accidents de la route
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    SQL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    • Résultats de football
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    • Résultats de football
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#competences-mises-en-uvre" class="md-nav__link">
    <span class="md-ellipsis">
      Compétences mises en œuvre
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#base-de-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      Base de données
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objectif" class="md-nav__link">
    <span class="md-ellipsis">
      Objectif
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    <span class="md-ellipsis">
      Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-quelles-equipes-participaient-au-championnat-de-l1-en-france-lors-de-la-saison-2020-2021" class="md-nav__link">
    <span class="md-ellipsis">
      1. Quelles équipes participaient au championnat de L1 en France lors de la saison 2020-2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-quel-a-ete-le-nombre-moyen-de-buts-par-match-en-l1-lors-de-la-saison-2020-2021" class="md-nav__link">
    <span class="md-ellipsis">
      2. Quel a été le nombre moyen de buts par match en L1 lors de la saison 2020-2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-quel-a-ete-le-pourcentage-de-victoires-a-domicile-de-victoires-a-lexterieur-et-de-matchs-nuls-en-l1-lors-de-la-saison-2020-2021" class="md-nav__link">
    <span class="md-ellipsis">
      3. Quel a été le pourcentage de victoires à domicile, de victoires à l'extérieur et de matchs nuls en L1 lors de la saison 2020-2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-quel-a-ete-le-nombre-de-buts-marques-par-equipe-en-l1-en-2020-2021" class="md-nav__link">
    <span class="md-ellipsis">
      4. Quel a été le nombre de buts marqués par équipe en L1 en 2020-2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-parmi-les-cinq-grands-championnats-angleterre-espagne-allemagne-italie-france-quelles-sont-les-5-equipes-a-avoir-gagne-le-plus-de-matchs-en-2020-2021" class="md-nav__link">
    <span class="md-ellipsis">
      5. Parmi les cinq grands championnats (Angleterre, Espagne, Allemagne, Italie, France), quelles sont les 5 équipes à avoir gagné le plus de matchs en 2020-2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-parmi-les-cinq-grands-championnats-quelles-sont-les-5-equipes-a-avoir-marque-le-plus-de-points-en-2020-2021" class="md-nav__link">
    <span class="md-ellipsis">
      6. Parmi les cinq grands championnats, quelles sont les 5 équipes à avoir marqué le plus de points en 2020-2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-quel-a-ete-le-podium-des-5-grands-championnats-en-2020-2021" class="md-nav__link">
    <span class="md-ellipsis">
      7. Quel a été le podium des 5 grands championnats en 2020-2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-quelles-equipes-ont-ete-en-l1-toutes-les-saisons-de-2005-a-2021" class="md-nav__link">
    <span class="md-ellipsis">
      8. Quelles équipes ont été en L1 toutes les saisons de 2005 à 2021 ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-lors-de-quels-matchs-y-a-t-il-eu-le-plus-de-buts" class="md-nav__link">
    <span class="md-ellipsis">
      9. Lors de quel(s) match(s) y-a-t-il eu le plus de buts ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-dans-les-5-grand-championnats-lors-de-quels-matchs-y-a-t-il-eu-le-plus-de-buts-lors-de-chaque-saison" class="md-nav__link">
    <span class="md-ellipsis">
      10. Dans les 5 grand championnats, lors de quels matchs y-a-t-il eu le plus de buts lors de chaque saison ?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tableur
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tableur
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    • Indice de Position Sociale des lycées
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mon parcours
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Mon parcours
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../APropos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    - A propos de moi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../competences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    - Compétences pour la Data Science
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experience/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    - Expérience professionnelle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../formation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    - Formation/Diplômes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="resultats-des-championnats-europeens-de-football-entre-2005-et-2021">Résultats des championnats européens de football entre 2005 et 2021</h1>
<hr />
<figure>
   <center>
     <img src="../../img/sql_football/terrain.jpg" alt="Terrain fooball" width=75%>
   </center>
</figure>

<h2 id="competences-mises-en-uvre">Compétences mises en œuvre</h2>
<hr />
<ul>
<li>Requêtes de base </li>
<li>Utilisation de Common Table Expressions (CTE)</li>
<li>Utilisation de Window Functions</li>
</ul>
<h2 id="base-de-donnees">Base de données</h2>
<hr />
<p>La base de données utilisée est en libre accès sur <a href="https://www.kaggle.com/datasets/groleo/european-football-database">www.kaggle.fr</a>. Il s'agit d'une base de données SQLite contenant les résultats des matchs de football des championnats européens entre les saisons 2005-2006 et 2020-2021. La base contient deux tables :</p>
<ul>
<li>
<p><strong>Table <em>divisions</em></strong> :</p>
<ul>
<li><em>division</em> : code du championnat</li>
<li><em>name</em> : nom du championnat</li>
<li><em>country</em> : pays du championnat</li>
</ul>
</li>
<li>
<p><strong>Table <em>matchs</em></strong>:</p>
<ul>
<li><em>Div</em> : code du championnat</li>
<li><em>Date</em> : date du match</li>
<li><em>HomeTeam</em> : équipe à domicile</li>
<li><em>AwayTeam</em> : équipe visiteuse</li>
<li><em>FTHG</em> : nombre de buts marqués par l'équipe à domicile</li>
<li><em>FTAG</em> : nombre de buts marqués par l'équipe visiteuse</li>
<li><em>FTR</em> : Résultat final (H=victoire de l'équipe à domicile, A=victoire de l'équipe visiteuse, D=match nul)</li>
<li><em>season</em> : saison </li>
</ul>
</li>
</ul>
<h2 id="objectif">Objectif</h2>
<hr />
<p>Il ne s'agit pas ici d'un projet. J'ai choisi d'écrire des questions et d'y répondre en effectuant des requêtes sur la base de données. L'ensemble des requêtes ont été réalisées sous le logiciel <strong>DBeaver</strong>.</p>
<h2 id="questions">Questions</h2>
<hr />
<h3 id="1-quelles-equipes-participaient-au-championnat-de-l1-en-france-lors-de-la-saison-2020-2021">1. Quelles équipes participaient au championnat de L1 en France lors de la saison 2020-2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">GROUP_CONCAT</span><span class="p">(</span><span class="n">Equipe</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipes</span>
<span class="k">FROM</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span>
<span class="w">     </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span>
<span class="w">     </span><span class="k">WHERE</span><span class="w"> </span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span>
<span class="w">     </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">ASC</span><span class="p">);</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Equipes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Angers, Bordeaux, Brest, Dijon, Lens, Lille, Lorient, Lyon, Marseille, Metz, Monaco, Montpellier, Nantes, Nice, Nimes, Paris SG, Reims, Rennes, St Etienne, Strasbourg</td>
</tr>
</tbody>
</table>
<h3 id="2-quel-a-ete-le-nombre-moyen-de-buts-par-match-en-l1-lors-de-la-saison-2020-2021">2. Quel a été le nombre moyen de buts par match en L1 lors de la saison 2020-2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">FTHG</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FTAG</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_buts_moyens</span><span class="p">,</span>
<span class="w">       </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">FTHG</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_buts_domicile_moyen</span><span class="p">,</span>
<span class="w">       </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">FTAG</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_buts_exterieur_moyen</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Nb_buts_moyens</th>
<th>Nb_buts_domicile_moyen</th>
<th>Nb_buts_exterieur_moyen</th>
</tr>
</thead>
<tbody>
<tr>
<td>2,8</td>
<td>1,4</td>
<td>1,4</td>
</tr>
</tbody>
</table>
<h3 id="3-quel-a-ete-le-pourcentage-de-victoires-a-domicile-de-victoires-a-lexterieur-et-de-matchs-nuls-en-l1-lors-de-la-saison-2020-2021">3. Quel a été le pourcentage de victoires à domicile, de victoires à l'extérieur et de matchs nuls en L1 lors de la saison 2020-2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Nombre total de matchs*/</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">nb_matchs</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre de victoires à domicile*/</span>
<span class="n">nb_vict_dom</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">FTR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;H&#39;</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre de victoires à l&#39;extérieur*/</span>
<span class="n">nb_vict_ext</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">FTR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A&#39;</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre de matchs nuls*/</span>
<span class="n">nb_nuls</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">FTR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;D&#39;</span>
<span class="w">  </span><span class="p">)</span>

<span class="cm">/*Calcul des pourcentages*/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">total</span><span class="o">*</span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="n">m</span><span class="p">.</span><span class="n">total</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pourc_victoire_dom</span><span class="p">,</span>
<span class="n">ROUND</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">total</span><span class="o">*</span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="n">m</span><span class="p">.</span><span class="n">total</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pourc_victoire_ext</span><span class="p">,</span>
<span class="n">ROUND</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">total</span><span class="o">*</span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="n">m</span><span class="p">.</span><span class="n">total</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pourc_matchs_nuls</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">nb_matchs</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb_vict_dom</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="p">,</span>
<span class="n">nb_vict_ext</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="p">,</span>
<span class="n">nb_nuls</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Pourc_victoire_dom</th>
<th>Pourc_victoire_ext</th>
<th>Pourc_matchs_nuls</th>
</tr>
</thead>
<tbody>
<tr>
<td>37,4</td>
<td>37,6</td>
<td>25</td>
</tr>
</tbody>
</table>
<h3 id="4-quel-a-ete-le-nombre-de-buts-marques-par-equipe-en-l1-en-2020-2021">4. Quel a été le nombre de buts marqués par équipe en L1 en 2020-2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Nombre de buts des équipes à domicile*/</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">buts_pour_dom</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">FTHG</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_buts_dom</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">HomeTeam</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre de buts des équipes à l&#39;extérieur*/</span>
<span class="n">buts_pour_ext</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">AwayTeam</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">FTAG</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_buts_ext</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">AwayTeam</span>
<span class="w">  </span><span class="p">)</span>

<span class="cm">/*Nombre total de buts par équipe*/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">Nb_buts_dom</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Nb_buts_ext</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_buts_marqués</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">buts_pour_dom</span><span class="w"> </span><span class="n">d</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">buts_pour_ext</span><span class="w"> </span><span class="n">e</span>
<span class="k">USING</span><span class="p">(</span><span class="n">Equipe</span><span class="p">)</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Nb_buts_marqués</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Equipe</th>
<th>Nb_buts_marqués</th>
</tr>
</thead>
<tbody>
<tr>
<td>Paris SG</td>
<td>86</td>
</tr>
<tr>
<td>Lyon</td>
<td>81</td>
</tr>
<tr>
<td>Monaco</td>
<td>76</td>
</tr>
<tr>
<td>Lille</td>
<td>64</td>
</tr>
<tr>
<td>Montpellier</td>
<td>60</td>
</tr>
<tr>
<td>Lens</td>
<td>55</td>
</tr>
<tr>
<td>Marseille</td>
<td>54</td>
</tr>
<tr>
<td>Rennes</td>
<td>52</td>
</tr>
<tr>
<td>Brest</td>
<td>50</td>
</tr>
<tr>
<td>Lorient</td>
<td>50</td>
</tr>
<tr>
<td>Nice</td>
<td>50</td>
</tr>
<tr>
<td>Strasbourg</td>
<td>49</td>
</tr>
<tr>
<td>Nantes</td>
<td>47</td>
</tr>
<tr>
<td>Metz</td>
<td>44</td>
</tr>
<tr>
<td>Bordeaux</td>
<td>42</td>
</tr>
<tr>
<td>Reims</td>
<td>42</td>
</tr>
<tr>
<td>St Etienne</td>
<td>42</td>
</tr>
<tr>
<td>Angers</td>
<td>40</td>
</tr>
<tr>
<td>Nimes</td>
<td>40</td>
</tr>
<tr>
<td>Dijon</td>
<td>25</td>
</tr>
</tbody>
</table>
<h3 id="5-parmi-les-cinq-grands-championnats-angleterre-espagne-allemagne-italie-france-quelles-sont-les-5-equipes-a-avoir-gagne-le-plus-de-matchs-en-2020-2021">5. Parmi les cinq grands championnats (Angleterre, Espagne, Allemagne, Italie, France), quelles sont les 5 équipes à avoir gagné le plus de matchs en 2020-2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Sélection des 5 championnats*/</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">TopChamp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">divisions</span><span class="w"> </span><span class="n">d</span>
<span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SP1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Calcul du nombre de victoires à domicile par équipe*/</span>
<span class="n">VictoiresDom</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_Victoires</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">TopChamp</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&gt;</span><span class="n">FTAG</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">HomeTeam</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Calcul du nombre de victoires à l&#39;extérieur par équipe*/</span>
<span class="n">VictoiresExt</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="n">AwayTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_Victoires</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">TopChamp</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&lt;</span><span class="n">FTAG</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">AwayTeam</span>
<span class="w">  </span><span class="p">)</span>

<span class="cm">/*Sélection des 5 équipes ayant le plus de victoires*/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">Nb_Victoires</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Nb_Victoires</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_Victoires</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">VictoiresDOM</span><span class="w"> </span><span class="n">d</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">VictoiresExt</span><span class="w"> </span><span class="n">e</span>
<span class="k">ON</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Championnat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Championnat</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Equipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Equipe</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Nb_Victoires</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Equipe</th>
<th>Championnat</th>
<th>Pays</th>
<th>Nb_Victoires</th>
</tr>
</thead>
<tbody>
<tr>
<td>Inter</td>
<td>Seria A</td>
<td>Italy</td>
<td>28</td>
</tr>
<tr>
<td>Man City</td>
<td>Premier League</td>
<td>England</td>
<td>27</td>
</tr>
<tr>
<td>Ath Madrid</td>
<td>LaLiga</td>
<td>Spain</td>
<td>26</td>
</tr>
<tr>
<td>Paris SG</td>
<td>Ligue 1</td>
<td>France</td>
<td>26</td>
</tr>
<tr>
<td>Real Madrid</td>
<td>LaLiga</td>
<td>Spain</td>
<td>25</td>
</tr>
</tbody>
</table>
<h3 id="6-parmi-les-cinq-grands-championnats-quelles-sont-les-5-equipes-a-avoir-marque-le-plus-de-points-en-2020-2021">6. Parmi les cinq grands championnats, quelles sont les 5 équipes à avoir marqué le plus de points en 2020-2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Sélection des 5 championnats*/</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">TopChamp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">divisions</span><span class="w"> </span><span class="n">d</span>
<span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SP1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Calcul du nombre de points par équipe par match*/</span>
<span class="n">AvecPoints</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span>
<span class="w">  </span><span class="k">CASE</span>
<span class="w">  </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&gt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span>
<span class="w">  </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&lt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">HomePoints</span><span class="p">,</span>
<span class="w">  </span><span class="k">CASE</span>
<span class="w">  </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&gt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&lt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span>
<span class="w">  </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">AwayPoints</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">TopChamp</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre total de points gagnés à domicile par équipe*/</span>
<span class="n">PointsDom</span><span class="w"> </span><span class="k">AS</span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">HomePoints</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Points</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">AvecPoints</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">Equipe</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre total de points gagnés à l&#39;extérieur par équipe*/</span>
<span class="n">PointsExt</span><span class="w"> </span><span class="k">AS</span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">AwayTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">AwayPoints</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Points</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">AvecPoints</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">Equipe</span>
<span class="w">  </span><span class="p">)</span>

<span class="cm">/*Podium par championnat*/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">Points</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">Points</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Points</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">PointsExt</span><span class="w"> </span><span class="n">e</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">PointsDom</span><span class="w"> </span><span class="n">d</span>
<span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Championnat</span><span class="o">=</span><span class="n">d</span><span class="p">.</span><span class="n">Championnat</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Equipe</span><span class="o">=</span><span class="n">d</span><span class="p">.</span><span class="n">Equipe</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Points</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Equipe</th>
<th>Championnat</th>
<th>Pays</th>
<th>Points</th>
</tr>
</thead>
<tbody>
<tr>
<td>Inter</td>
<td>Seria A</td>
<td>Italy</td>
<td>91</td>
</tr>
<tr>
<td>Ath Madrid</td>
<td>LaLiga</td>
<td>Spain</td>
<td>86</td>
</tr>
<tr>
<td>Man City</td>
<td>Premier League</td>
<td>England</td>
<td>86</td>
</tr>
<tr>
<td>Real Madrid</td>
<td>LaLiga</td>
<td>Spain</td>
<td>84</td>
</tr>
<tr>
<td>Lille</td>
<td>Ligue 1</td>
<td>France</td>
<td>83</td>
</tr>
</tbody>
</table>
<h3 id="7-quel-a-ete-le-podium-des-5-grands-championnats-en-2020-2021">7. Quel a été le podium des 5 grands championnats en 2020-2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Sélection des 5 championnats*/</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">TopChamp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">divisions</span><span class="w"> </span><span class="n">d</span>
<span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SP1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Calcul du nombre de points par équipe par match*/</span>
<span class="n">AvecPoints</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span>
<span class="w">    </span><span class="k">CASE</span>
<span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&gt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span>
<span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&lt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">HomePoints</span><span class="p">,</span>
<span class="w">    </span><span class="k">CASE</span>
<span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&gt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="n">FTHG</span><span class="o">&lt;</span><span class="n">FTAG</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span>
<span class="w">      </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">AwayPoints</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">TopChamp</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre total de points gagnés à domicile par équipe*/</span>
<span class="n">PointsDom</span><span class="w"> </span><span class="k">AS</span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">HomePoints</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Points</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">AvecPoints</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">Equipe</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Nombre total de points gagnés à l&#39;extérieur par équipe*/</span>
<span class="n">PointsExt</span><span class="w"> </span><span class="k">AS</span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">AwayTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">AwayPoints</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Points</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">AvecPoints</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">Equipe</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Classement par championnat*/</span>
<span class="n">ClassementChamp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">Points</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">Points</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Points</span><span class="p">,</span>
<span class="w">    </span><span class="n">RANK</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Championnat</span>
<span class="w">                </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Points</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="n">Points</span><span class="w"> </span><span class="k">DESC</span>
<span class="w">               </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Classement</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">PointsExt</span><span class="w"> </span><span class="n">e</span>
<span class="w">  </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">PointsDom</span><span class="w"> </span><span class="n">d</span>
<span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Championnat</span><span class="o">=</span><span class="n">d</span><span class="p">.</span><span class="n">Championnat</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Equipe</span><span class="o">=</span><span class="n">d</span><span class="p">.</span><span class="n">Equipe</span>
<span class="p">)</span>

<span class="cm">/*Podium par championnat*/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">Pays</span><span class="p">,</span><span class="w"> </span><span class="n">Classement</span><span class="p">,</span><span class="w"> </span><span class="n">Equipe</span><span class="p">,</span><span class="w"> </span><span class="n">Points</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ClassementChamp</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">Classement</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Championnat</th>
<th>Pays</th>
<th>Classement</th>
<th>Equipe</th>
<th>Points</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bundesliga</td>
<td>Deutschland</td>
<td>1</td>
<td>Bayern Munich</td>
<td>78</td>
</tr>
<tr>
<td>Bundesliga</td>
<td>Deutschland</td>
<td>2</td>
<td>RB Leipzig</td>
<td>65</td>
</tr>
<tr>
<td>Bundesliga</td>
<td>Deutschland</td>
<td>3</td>
<td>Dortmund</td>
<td>64</td>
</tr>
<tr>
<td>LaLiga</td>
<td>Spain</td>
<td>1</td>
<td>Ath Madrid</td>
<td>86</td>
</tr>
<tr>
<td>LaLiga</td>
<td>Spain</td>
<td>2</td>
<td>Real Madrid</td>
<td>84</td>
</tr>
<tr>
<td>LaLiga</td>
<td>Spain</td>
<td>3</td>
<td>Barcelona</td>
<td>79</td>
</tr>
<tr>
<td>Ligue 1</td>
<td>France</td>
<td>1</td>
<td>Lille</td>
<td>83</td>
</tr>
<tr>
<td>Ligue 1</td>
<td>France</td>
<td>2</td>
<td>Paris SG</td>
<td>82</td>
</tr>
<tr>
<td>Ligue 1</td>
<td>France</td>
<td>3</td>
<td>Monaco</td>
<td>78</td>
</tr>
<tr>
<td>Premier League</td>
<td>England</td>
<td>1</td>
<td>Man City</td>
<td>86</td>
</tr>
<tr>
<td>Premier League</td>
<td>England</td>
<td>2</td>
<td>Man United</td>
<td>74</td>
</tr>
<tr>
<td>Premier League</td>
<td>England</td>
<td>3</td>
<td>Liverpool</td>
<td>69</td>
</tr>
<tr>
<td>Seria A</td>
<td>Italy</td>
<td>1</td>
<td>Inter</td>
<td>91</td>
</tr>
<tr>
<td>Seria A</td>
<td>Italy</td>
<td>2</td>
<td>Milan</td>
<td>79</td>
</tr>
<tr>
<td>Seria A</td>
<td>Italy</td>
<td>3</td>
<td>Atalanta</td>
<td>78</td>
</tr>
<tr>
<td>Seria A</td>
<td>Italy</td>
<td>3</td>
<td>Juventus</td>
<td>78</td>
</tr>
</tbody>
</table>
<h3 id="8-quelles-equipes-ont-ete-en-l1-toutes-les-saisons-de-2005-a-2021">8. Quelles équipes ont été en L1 toutes les saisons de 2005 à 2021 ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Sélection des équipes qui ont toujours été en Ligue 1 depuis la saison 2005-2006 */</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">GROUP_CONCAT</span><span class="p">(</span><span class="n">Equipe</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipes</span>
<span class="k">FROM</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe</span>
<span class="w">     </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">     </span><span class="k">WHERE</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span>
<span class="w">     </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">HomeTeam</span>
<span class="w">     </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="p">(</span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">season</span><span class="p">)</span>
<span class="w">                                       </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="p">)</span>
<span class="w">     </span><span class="p">);</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Equipes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bordeaux, Lille, Lyon, Marseille, Nice, Paris SG, Rennes, St Etienne</td>
</tr>
</tbody>
</table>
<h3 id="9-lors-de-quels-matchs-y-a-t-il-eu-le-plus-de-buts">9. Lors de quel(s) match(s) y-a-t-il eu le plus de buts ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Calcul du nombre de buts par match*/</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">Buts_par_match</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">Date</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe_domicile</span><span class="w"> </span><span class="p">,</span><span class="n">m</span><span class="p">.</span><span class="n">AwayTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe_extérieur</span><span class="p">,</span>
<span class="w">         </span><span class="n">m</span><span class="p">.</span><span class="n">FTHG</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Buts_équipe_dom</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">FTAG</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Buts_équipe_ext</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">FTHG</span><span class="o">+</span><span class="n">m</span><span class="p">.</span><span class="n">FTAG</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_total_buts</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="p">)</span>

<span class="cm">/*Sélection du(des) match(s) avec le plus de buts*/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="nb">Date</span><span class="p">,</span><span class="w"> </span><span class="n">Equipe_domicile</span><span class="p">,</span><span class="w"> </span><span class="n">Equipe_extérieur</span><span class="p">,</span><span class="w"> </span><span class="n">Buts_équipe_dom</span><span class="p">,</span><span class="w"> </span><span class="n">Buts_équipe_ext</span><span class="p">,</span><span class="w"> </span><span class="n">Nb_total_buts</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Buts_par_match</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">Nb_total_buts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">Nb_total_buts</span><span class="p">)</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Buts_par_match</span><span class="p">);</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Date</th>
<th>Equipe_domicile</th>
<th>Equipe_extérieur</th>
<th>Buts_équipe_dom</th>
<th>Buts_équipe_ext</th>
<th>Nb_total_buts</th>
</tr>
</thead>
<tbody>
<tr>
<td>2020-10-24</td>
<td>VVV Venlo</td>
<td>Ajax</td>
<td>0</td>
<td>13</td>
<td>13</td>
</tr>
</tbody>
</table>
<h3 id="10-dans-les-5-grand-championnats-lors-de-quels-matchs-y-a-t-il-eu-le-plus-de-buts-lors-de-chaque-saison">10. Dans les 5 grand championnats, lors de quels matchs y-a-t-il eu le plus de buts lors de chaque saison ?</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/*Calcul du nombre de buts par match dans les 5 grands championnats*/</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">Buts_par_match</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">Date</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span>
<span class="w">         </span><span class="n">m</span><span class="p">.</span><span class="n">HomeTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe_domicile</span><span class="w"> </span><span class="p">,</span><span class="n">m</span><span class="p">.</span><span class="n">AwayTeam</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Equipe_extérieur</span><span class="p">,</span>
<span class="w">         </span><span class="n">m</span><span class="p">.</span><span class="n">FTHG</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Buts_équipe_dom</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">FTAG</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Buts_équipe_ext</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">FTHG</span><span class="o">+</span><span class="n">m</span><span class="p">.</span><span class="n">FTAG</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nb_total_buts</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">matchs</span><span class="w"> </span><span class="n">m</span>
<span class="w">  </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">divisions</span><span class="w"> </span><span class="n">d</span>
<span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span>
<span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">division</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SP1&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">),</span>

<span class="cm">/*Calcul du nombre max de buts par saison*/</span>
<span class="n">Max_buts</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">Nb_total_buts</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">maxi</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">Buts_par_match</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">season</span>
<span class="w">  </span><span class="p">)</span>

<span class="cm">/*Matchs avec le plus de buts pour chaque saison*/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="nb">Date</span><span class="p">,</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">Championnat</span><span class="p">,</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">Equipe_domicile</span><span class="p">,</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">Equipe_extérieur</span><span class="p">,</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">Buts_équipe_dom</span><span class="p">,</span>
<span class="n">bpm</span><span class="p">.</span><span class="n">Buts_équipe_ext</span><span class="p">,</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">Nb_total_buts</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Buts_par_match</span><span class="w"> </span><span class="n">bpm</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Max_buts</span><span class="w"> </span><span class="n">mb</span>
<span class="k">ON</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mb</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">Nb_total_buts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mb</span><span class="p">.</span><span class="n">maxi</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">bpm</span><span class="p">.</span><span class="n">season</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Season</th>
<th>Date</th>
<th>Championnat</th>
<th>Equipe_domicile</th>
<th>Equipe_extérieur</th>
<th>Buts_équipe_dom</th>
<th>Buts_équipe_ext</th>
<th>Nb_total_buts</th>
</tr>
</thead>
<tbody>
<tr>
<td>2021</td>
<td>2020-10-04</td>
<td>Premier League</td>
<td>Aston Villa</td>
<td>Liverpool</td>
<td>7</td>
<td>2</td>
<td>9</td>
</tr>
<tr>
<td>2021</td>
<td>2021-02-02</td>
<td>Premier League</td>
<td>Man United</td>
<td>Southampton</td>
<td>9</td>
<td>0</td>
<td>9</td>
</tr>
<tr>
<td>2020</td>
<td>2019-10-25</td>
<td>Premier League</td>
<td>Southampton</td>
<td>Leicester</td>
<td>0</td>
<td>9</td>
<td>9</td>
</tr>
<tr>
<td>2020</td>
<td>2020-03-01</td>
<td>Seria A</td>
<td>Lecce</td>
<td>Atalanta</td>
<td>2</td>
<td>7</td>
<td>9</td>
</tr>
<tr>
<td>2019</td>
<td>2018-09-02</td>
<td>LaLiga</td>
<td>Barcelona</td>
<td>Huesca</td>
<td>8</td>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>2018</td>
<td>2017-10-14</td>
<td>Premier League</td>
<td>Man City</td>
<td>Stoke</td>
<td>7</td>
<td>2</td>
<td>9</td>
</tr>
<tr>
<td>2018</td>
<td>2018-05-13</td>
<td>Premier League</td>
<td>Tottenham</td>
<td>Leicester</td>
<td>5</td>
<td>4</td>
<td>9</td>
</tr>
<tr>
<td>2018</td>
<td>2018-02-02</td>
<td>Ligue 1</td>
<td>Marseille</td>
<td>Metz</td>
<td>6</td>
<td>3</td>
<td>9</td>
</tr>
<tr>
<td>2018</td>
<td>2017-10-15</td>
<td>LaLiga</td>
<td>Betis</td>
<td>Valencia</td>
<td>3</td>
<td>6</td>
<td>9</td>
</tr>
<tr>
<td>2018</td>
<td>2018-03-18</td>
<td>LaLiga</td>
<td>Real Madrid</td>
<td>Girona</td>
<td>6</td>
<td>3</td>
<td>9</td>
</tr>
<tr>
<td>2018</td>
<td>2018-05-13</td>
<td>LaLiga</td>
<td>Levante</td>
<td>Barcelona</td>
<td>5</td>
<td>4</td>
<td>9</td>
</tr>
<tr>
<td>2017</td>
<td>2017-05-07</td>
<td>Seria A</td>
<td>Lazio</td>
<td>Sampdoria</td>
<td>7</td>
<td>3</td>
<td>10</td>
</tr>
<tr>
<td>2017</td>
<td>2016-08-20</td>
<td>LaLiga</td>
<td>Sevilla</td>
<td>Espanol</td>
<td>6</td>
<td>4</td>
<td>10</td>
</tr>
<tr>
<td>2016</td>
<td>2015-12-20</td>
<td>LaLiga</td>
<td>Real Madrid</td>
<td>Vallecano</td>
<td>10</td>
<td>2</td>
<td>12</td>
</tr>
<tr>
<td>2015</td>
<td>2014-09-20</td>
<td>LaLiga</td>
<td>La Coruna</td>
<td>Real Madrid</td>
<td>2</td>
<td>8</td>
<td>10</td>
</tr>
<tr>
<td>2015</td>
<td>2015-04-05</td>
<td>LaLiga</td>
<td>Real Madrid</td>
<td>Granada</td>
<td>9</td>
<td>1</td>
<td>10</td>
</tr>
<tr>
<td>2015</td>
<td>2015-05-23</td>
<td>LaLiga</td>
<td>Real Madrid</td>
<td>Getafe</td>
<td>7</td>
<td>3</td>
<td>10</td>
</tr>
<tr>
<td>2014</td>
<td>2013-10-30</td>
<td>LaLiga</td>
<td>Real Madrid</td>
<td>Sevilla</td>
<td>7</td>
<td>3</td>
<td>10</td>
</tr>
<tr>
<td>2013</td>
<td>2013-03-30</td>
<td>Bundesliga</td>
<td>Bayern Munich</td>
<td>Hamburg</td>
<td>9</td>
<td>2</td>
<td>11</td>
</tr>
<tr>
<td>2012</td>
<td>2011-08-28</td>
<td>Premier League</td>
<td>Man United</td>
<td>Arsenal</td>
<td>8</td>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>2011</td>
<td>2010-08-29</td>
<td>Bundesliga</td>
<td>Leverkusen</td>
<td>M'gladbach</td>
<td>3</td>
<td>6</td>
<td>9</td>
</tr>
<tr>
<td>2011</td>
<td>2011-05-07</td>
<td>Bundesliga</td>
<td>St Pauli</td>
<td>Bayern Munich</td>
<td>1</td>
<td>8</td>
<td>9</td>
</tr>
<tr>
<td>2011</td>
<td>2010-12-04</td>
<td>Ligue 1</td>
<td>Lille</td>
<td>Lorient</td>
<td>6</td>
<td>3</td>
<td>9</td>
</tr>
<tr>
<td>2011</td>
<td>2011-04-23</td>
<td>LaLiga</td>
<td>Valencia</td>
<td>Real Madrid</td>
<td>3</td>
<td>6</td>
<td>9</td>
</tr>
<tr>
<td>2011</td>
<td>2011-05-21</td>
<td>LaLiga</td>
<td>Real Madrid</td>
<td>Almeria</td>
<td>8</td>
<td>1</td>
<td>9</td>
</tr>
<tr>
<td>2010</td>
<td>2009-11-22</td>
<td>Premier League</td>
<td>Tottenham</td>
<td>Wigan</td>
<td>9</td>
<td>1</td>
<td>10</td>
</tr>
<tr>
<td>2010</td>
<td>2009-11-08</td>
<td>Ligue 1</td>
<td>Lyon</td>
<td>Marseille</td>
<td>5</td>
<td>5</td>
<td>10</td>
</tr>
<tr>
<td>2009</td>
<td>2008-09-27</td>
<td>Bundesliga</td>
<td>Werder Bremen</td>
<td>Hoffenheim</td>
<td>5</td>
<td>4</td>
<td>9</td>
</tr>
<tr>
<td>2008</td>
<td>2007-09-29</td>
<td>Premier League</td>
<td>Portsmouth</td>
<td>Reading</td>
<td>7</td>
<td>4</td>
<td>11</td>
</tr>
<tr>
<td>2007</td>
<td>2007-04-01</td>
<td>LaLiga</td>
<td>Santander</td>
<td>Ath Bilbao</td>
<td>5</td>
<td>4</td>
<td>9</td>
</tr>
<tr>
<td>2006</td>
<td>2006-02-11</td>
<td>Bundesliga</td>
<td>Schalke 04</td>
<td>Leverkusen</td>
<td>7</td>
<td>4</td>
<td>11</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.indexes", "toc.integrate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>